@startuml

' === Assignment ===
interface AssignmentDao {
    + save(assignment: Assignment)
    + saveAll(assignments: List<Assignment>)
    + findByCourse(course: Course): List<Assignment>
    + deleteByCourse(existingCourse: Course)
    + existsById(id: String): boolean
    + findById(id: String): Assignment
    + deleteAll(values: Collection<Assignment>)
    + delete(existingAssignment: Assignment)
}

class AssignmentDaoImpl {
    - assignmentRepository: AssignmentRepository
}

AssignmentDaoImpl ..|> AssignmentDao

' === Availability ===
interface AvailabilityDao {
    + save(availability: Availability): Availability
    + saveAll(availabilities: List<Availability>): List<Availability>
    + findByUser(user: User): List<Availability>
    + deleteByUser(user: User)
    + deleteAll(toDelete: List<Availability>)
}

class AvailabilityDaoImpl {
    - availabilityRepository: AvailabilityRepository
}

AvailabilityDaoImpl ..|> AvailabilityDao

' === Course ===
interface CourseDao {
    + save(course: Course): Course
    + saveAll(courses: List<Course>): List<Course>
    + findByTerm(term: Term): List<Course>
    + findById(courseId: Long): Course
    + delete(existingCourse: Course)
    + flush()
    + deleteAllByIdInBatch(idsToDelete: Set<Long>)
}

class CourseDaoImpl {
    - courseRepository: CourseRepository
}

CourseDaoImpl ..|> CourseDao

' === Exam ===
interface ExamDao {
    + save(exam: Exam)
    + saveAll(exams: List<Exam>)
    + findByCourse(course: Course): List<Exam>
    + deleteByCourse(existingCourse: Course)
    + existsById(id: String): boolean
    + findById(id: String): Exam
    + deleteAll(values: Collection<Exam>)
    + delete(existingExam: Exam)
}

class ExamDaoImpl {
    - examRepository: ExamRepository
}

ExamDaoImpl ..|> ExamDao

' === FocusSession ===
interface FocusSessionDao {
    + save(focusSession: FocusSession): FocusSession
    + findById(id: String): FocusSession
    + sumFocusSecondsByUser(uid: String): long
    + findByUserUidAndStatus(userUid: String, focusStatus: FocusStatus): FocusSession
    + delete(focusSession: FocusSession)
}

class FocusSessionDaoImpl {
    - focusSessionRepository: FocusSessionRepository
}

FocusSessionDaoImpl ..|> FocusSessionDao

' === GroupMember ===
interface GroupMemberDao {
    + save(groupMember: GroupMember): GroupMember
    + existsByUserAndGroup(user: User, group: StudyGroup): Boolean
    + findByUser(user: User): List<GroupMember>
    + findByGroupId(groupId: Long): List<GroupMember>
}

class GroupMemberDaoImpl {
    - groupMemberRepository: GroupMemberRepository
}

GroupMemberDaoImpl ..|> GroupMemberDao

' === Notification ===
interface NotificationDao {
    + getNotificationById(id: Long): Notification
    + saveNotification(notification: Notification)
    + getNotificationsByUser(user: User): List<Notification>
}

class NotificationDaoImpl {
    - notificationRepository: NotificationRepository
}

NotificationDaoImpl ..|> NotificationDao

' === PendingNotification ===
interface PendingNotificationDao {
    + findByTargetUserUid(targetUserUid: String): List<PendingNotification>
    + save(pending: PendingNotification)
    + delete(pending: PendingNotification)
}

class PendingNotificationDaoImpl {
    - pendingNotificationRepository: PendingNotificationRepository
}

PendingNotificationDaoImpl ..|> PendingNotificationDao

' === Schedule ===
interface ScheduleDao {
    + findByUser(user: User): List<Schedule>
    + save(schedule: Schedule): Schedule
    + findById(id: String): Optional<Schedule>
}

class ScheduleDaoImpl {
    - scheduleRepository: ScheduleRepository
}

ScheduleDaoImpl ..|> ScheduleDao

' === Session ===
interface SessionDao {
    + getOverdueSessions(user: User): List<Session>
    + getTodaySessions(user: User): List<Session>
    + getTomorrowSessions(user: User): List<Session>
    + getFutureSessions(user: User): List<Session>
    + save(session: Session): Session
    + findById(id: String): Session
    + countTotalPlannedSessionsForUser(uid: String): int
    + countCompletedSessionsForUser(uid: String): int
    + getCompletedSessions(user: User): List<Session>
}

class SessionDaoImpl {
    - sessionRepository: SessionRepository
}

SessionDaoImpl ..|> SessionDao

' === StudyAnalytics ===
interface StudyAnalyticsDao {
    + countCompletedSessions(userUid: String, range: String, date: LocalDate): int
    + sumFocusDuration(userUid: String, range: String, date: LocalDate): long
    + getSubjectBreakdown(userUid: String, range: String, date: LocalDate): Map<String, Long>
    + getCompletedSessionsWithTimes(userUid: String, range: String, date: LocalDate): List<Object[]>
}

class StudyAnalyticsDaoImpl {
    - focusSessionRepository: FocusSessionRepository
}

StudyAnalyticsDaoImpl ..|> StudyAnalyticsDao

' === StudyGroup ===
interface StudyGroupDao {
    + save(studyGroup: StudyGroup): StudyGroup
    + existsByJoinCode(code: String): boolean
    + findByJoinCode(joinCode: String): Optional<StudyGroup>
}

class StudyGroupDaoImpl {
    - studyGroupRepository: StudyGroupRepository
}

StudyGroupDaoImpl ..|> StudyGroupDao

' === StudyPreference ===
interface StudyPreferenceDao {
    + savePreference(preference: StudyPreference): StudyPreference
    + findByUserUid(userUid: String): StudyPreference
}

class StudyPreferenceDaoImpl {
    - repository: StudyPreferenceRepository
}

StudyPreferenceDaoImpl ..|> StudyPreferenceDao

' === Term ===
interface TermDao {
    + save(term: Term): Term
    + findByUser(user: User): Term
    + findById(id: Long): Optional<Term>
    + getCurrentTermByUser(user: User): Optional<Term>
}

class TermDaoImpl {
    - termRepository: TermRepository
}

TermDaoImpl ..|> TermDao

' === Topic ===
interface TopicDao {
    + save(topic: Topic): Topic
    + saveAll(topics: List<Topic>)
    + findByCourse(course: Course): List<Topic>
    + findById(topicId: String): Topic
    + deleteByCourse(existingCourse: Course)
    + existsById(id: String): boolean
    + deleteById(existingId: String)
}

class TopicDaoImpl {
    - topicRepository: TopicRepository
}

TopicDaoImpl ..|> TopicDao

' === User ===
interface UserDao {
    + save(user: User): User
    + findByUid(uid: String): User
    + findByEmail(email: String): Optional<User>
}

class UserDaoImpl {
    - userRepository: UserRepository
}

UserDaoImpl ..|> UserDao

@enduml
